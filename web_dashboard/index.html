<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR Dashboard - PHOENICIAN</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Login Section -->
    <div id="loginContainer" class="login-container">
        <div class="login-box">
            <h2>HR Dashboard Login</h2>
            <input type="email" id="email" placeholder="Email">
            <input type="password" id="password" placeholder="Password">
            <button onclick="login()">Login</button>
        </div>
    </div>

    <!-- Dashboard Section (Hidden by default) -->
    <div id="dashboardContainer" class="dashboard-container" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h2>PHOENICIAN</h2>
                <p>HR Dashboard</p>
            </div>
            <nav>
                <a href="#" class="nav-item active" onclick="showSection('attendance', event)">
                    <span>ðŸ“Š</span> Attendance
                </a>
                <a href="#" class="nav-item" onclick="showSection('employees', event)">
                    <span>ðŸ‘¥</span> Employees
                </a>
                <a href="#" class="nav-item" onclick="showSection('mastersheet', event)">
                    <span>ðŸ“‹</span> MasterSheet
                </a>
                <a href="#" class="nav-item" onclick="showSection('managers', event)">
                    <span>ðŸ‘”</span> Managers
                </a>
                <a href="#" class="nav-item" onclick="logout()">
                    <span>ðŸšª</span> Logout
                </a>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Attendance Section -->
            <div id="attendanceSection" class="section">
                <div class="header">
                    <h1>Employee Attendance</h1>
                </div>

                <!-- Date Filter -->
                <div class="filters">
                    <input type="date" id="dateFilter" onchange="filterByDate()">
                    <select id="employeeFilter" onchange="filterByEmployee()">
                        <option value="">All Employees</option>
                    </select>
                </div>

                <!-- Attendance Table -->
                <div class="attendance-container">
                    <table id="attendanceTable">
                        <thead>
                            <tr>
                                <th>Employee Name</th>
                                <th>Date</th>
                                <th>Check In</th>
                                <th>Check Out</th>
                                <th>Total Hours</th>
                                <th>Status</th>
                                <th>Location</th>
                            </tr>
                        </thead>
                        <tbody id="attendanceData">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Employee Management Section -->
            <div id="employeesSection" class="section" style="display: none;">
                <div class="header">
                    <h1>Employee Management</h1>
                    <button class="btn-primary" onclick="showAddEmployeeModal()">Add Employee</button>
                </div>

                <!-- Excel Upload Section -->
                <div class="upload-section">
                    <h3>Import</h3>
                    <p>Upload Excel file with employee data</p>
                    <input type="file" id="excelFile" accept=".xlsx,.xls" onchange="handleExcelUpload(event)">
                    <button class="btn-secondary" onclick="downloadTemplate()">Download Template</button>
                </div>

                <!-- Employee List -->
                <div class="employee-list-container">
                    <table id="employeeTable">
                        <thead>
                            <tr>
                                <th>PIN</th>
                                <th>Name</th>
                                <th>Designation</th>
                                <th>Department</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="employeeData">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- MasterSheet Section -->
            <div id="mastersheetSection" class="section" style="display: none;">
                <div class="header">
                    <h1>Employee MasterSheet</h1>
                </div>

                <!-- Excel Upload Section for MasterSheet -->
                <div class="upload-section">
                    <h3>Import Employee Data to MasterSheet</h3>
                    <p>Upload Excel file with employee data (Employee Number, Name, Designation, Salary)</p>
                    <input type="file" id="mastersheetExcelFile" accept=".xlsx,.xls" onchange="handleMasterSheetExcelUpload(event)">
                    <button class="btn-secondary" onclick="downloadMasterSheetTemplate()">Download Template</button>
                </div>

                <div class="upload-section">
                    <h3>Import Overtime Data</h3>
                    <p>Upload Excel file with employee overtime data (Employee Number, Employee Name, Overtime)</p>
                    <input type="file" id="overtimeExcelFile" accept=".xlsx,.xls" onchange="handleOvertimeExcelUpload(event)">
                    <button class="btn-secondary" onclick="downloadOvertimeTemplate()">Download Overtime Template</button>
                </div>

                <!-- MasterSheet Employee List -->
                <div class="employee-list-container">
                    <table id="mastersheetTable">
                        <thead>
                            <tr>
                                <th>Employee Number</th>
                                <th>Employee Name</th>
                                <th>Designation</th>
                                <th>Salary</th>
                                <th>Overtime</th>
                                <th>Created By</th>
                                <th>Created On</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="mastersheetData">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Managers Section -->
            <div id="managersSection" class="section" style="display: none;">
                <div class="header">
                    <h1>Line Managers</h1>
                    <button class="btn-primary" onclick="showAddManagerModal()">Add Line Manager</button>
                </div>

                <!-- Manager List -->
                <div class="manager-list-container">
                    <table id="managerTable">
                        <thead>
                            <tr>
                                <th>Manager PIN</th>
                                <th>Manager Name</th>
                                <th>Department</th>
                                <th>Team Members</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="managerData">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Employee Modal -->
    <div id="addEmployeeModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Employee</h2>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="employeeForm">
                    <div class="form-group">
                        <label>PIN (4 digits)*</label>
                        <div style="display: flex; gap: 5px;">
                            <input type="text" id="empPin" maxlength="4" pattern="\d{4}" required style="flex: 1;">
                            <button type="button" class="btn-small" onclick="document.getElementById('empPin').value = generateRandomPIN()">Generate</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Full Name*</label>
                        <input type="text" id="empName" required>
                    </div>
                    <div class="form-group">
                        <label>Designation*</label>
                        <input type="text" id="empDesignation" required>
                    </div>
                    <div class="form-group">
                        <label>Department*</label>
                        <input type="text" id="empDepartment" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="empEmail">
                    </div>
                    <div class="form-group">
                        <label>Phone</label>
                        <input type="tel" id="empPhone">
                    </div>
                    <div class="form-group">
                        <label>Country</label>
                        <input type="text" id="empCountry">
                    </div>
                    <div class="form-group">
                        <label>Birthdate</label>
                        <input type="date" id="empBirthdate">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeModal()">Cancel</button>
                        <button type="submit" class="btn-primary">Add Employee</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Line Manager Modal -->
    <div id="addManagerModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add Line Manager</h2>
                <span class="close" onclick="closeManagerModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="managerForm">
                    <div class="form-group">
                        <label>Select Employee to be Manager</label>
                        <select id="managerEmployeeSelect" required>
                            <option value="">-- Select Employee --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Department</label>
                        <input type="text" id="managerDepartment" required>
                    </div>
                    <div class="form-group">
                        <label>Team Members (Employee Numbers, comma separated)</label>
                        <input type="text" id="teamMembers" placeholder="1213, 2745, 3577, 3576">
                        <small style="color: #666;">Enter employee numbers from MasterSheet</small>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeManagerModal()">Cancel</button>
                        <button type="submit" class="btn-primary">Add Manager</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Edit Manager Modal -->
    <div id="editManagerModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Line Manager</h2>
                <span class="close" onclick="closeEditManagerModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="editManagerForm">
                    <input type="hidden" id="editManagerId">
                    <div class="form-group">
                        <label>Manager Name</label>
                        <input type="text" id="editManagerName" readonly>
                    </div>
                    <div class="form-group">
                        <label>Department</label>
                        <input type="text" id="editManagerDepartment" required>
                    </div>
                    <div class="form-group">
                        <label>Team Members (Employee PINs, comma separated)</label>
                        <input type="text" id="editTeamMembers" placeholder="1213, 2745, 3577, 3576">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeEditManagerModal()">Cancel</button>
                        <button type="submit" class="btn-primary">Update Manager</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <script src="firebase-config.js"></script>
    <script src="script.js"></script>
</body>
</html>